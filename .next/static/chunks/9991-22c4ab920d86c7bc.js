"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9991],{12381:function(e,t,r){r.d(t,{z:function(){return s}});var n=r(57437),o=r(2265),a=r(37053),c=r(90535),u=r(93448);let i=(0,c.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),s=o.forwardRef((e,t)=>{let{className:r,variant:o,size:c,asChild:s=!1,...l}=e,d=s?a.g7:"button";return(0,n.jsx)(d,{className:(0,u.cn)(i({variant:o,size:c,className:r})),ref:t,...l})});s.displayName="Button"},40282:function(e,t,r){r.d(t,{Db:function(){return d},h_:function(){return l},x1:function(){return s}});var n=r(2265);let o=e=>new Promise(t=>setTimeout(t,e)),a=new Map,c=new Map,u=new Map,i=new Map;function s(e){if(!e){a.clear(),console.log("Cache API enti\xe8rement vid\xe9");return}if(a.has(e)){a.delete(e),console.log("Cache pour ".concat(e," vid\xe9"));return}let t=0;for(let r of Array.from(a.keys()))r.includes(e)&&(a.delete(r),t++);t>0&&console.log("".concat(t,' entr\xe9es de cache contenant "').concat(e,'" ont \xe9t\xe9 vid\xe9es'))}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[r,s]=(0,n.useState)(null),[l,d]=(0,n.useState)(null),[f,h]=(0,n.useState)(!0),m=(0,n.useRef)(null),g=(0,n.useRef)(!0),v=(0,n.useRef)(!0),p=(0,n.useRef)(!1);if(!e||""===e)return{data:null,error:"URL invalide",loading:!1,refetch:async()=>{},stopAutoRefresh:()=>{}};(0,n.useEffect)(()=>{g.current=!0;let t=i.get(e)||0;return i.set(e,t+1),()=>{g.current=!1,m.current&&clearTimeout(m.current);let t=i.get(e)||0;t>0&&i.set(e,t-1),0===(i.get(e)||0)&&c.set(e,!1)}},[e]);let y=(0,n.useCallback)(async function(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(p.current&&!n||c.get(e))return;let l=Date.now(),f=u.get(e)||0;if(!n&&!v.current&&l-f<1e4)return;if(c.set(e,!0),u.set(e,l),p.current=!0,!n){let t=a.get(e);if(t&&l-t.timestamp<6e4){g.current&&(s(t.data),h(!1)),c.set(e,!1);return}}let w=t.retries||1,b=t.retryDelay||2e3,E=0,T=!1;try{for(g.current&&(r||h(!0),d(null));!T&&E<=w;)try{let r={method:t.method||"GET",headers:{"Content-Type":"application/json",...t.headers},cache:"no-store"};t.body&&"GET"!==t.method&&(r.body=JSON.stringify(t.body));let n=new AbortController,o=setTimeout(()=>n.abort(),15e3);r.signal=n.signal;let c=await fetch(e,r);if(clearTimeout(o),!c.ok){if(c.status>=500&&E<w)throw Error("Erreur serveur ".concat(c.status));if(401===c.status)throw Error("Vous devez \xeatre connect\xe9 pour acc\xe9der \xe0 cette ressource");let e=await c.json().catch(()=>({}));throw Error(e.error||"Erreur ".concat(c.status,": ").concat(c.statusText))}let u=await c.json();a.set(e,{data:u,timestamp:Date.now()}),g.current&&s(u),T=!0,v.current=!1;break}catch(t){if(t instanceof DOMException&&"AbortError"===t.name)throw Error("La requ\xeate a pris trop de temps");if(E<w)0===E&&console.warn("Tentative \xe9chou\xe9e pour ".concat(e,". Nouvelle tentative...")),await o(b*(E+1)),E++;else throw t}}catch(t){console.error("Erreur lors de l'appel \xe0 ".concat(e)),r?g.current&&d("Erreur de rafra\xeechissement. Donn\xe9es potentiellement obsol\xe8tes."):t instanceof TypeError&&t.message.includes("fetch")?g.current&&d("Probl\xe8me de connexion au serveur. Veuillez v\xe9rifier votre connexion internet."):g.current&&d(t instanceof Error?t.message:"Une erreur est survenue")}finally{1>=(i.get(e)||0)&&c.set(e,!1),g.current&&h(!1),g.current&&t.refreshInterval&&t.refreshInterval>0&&(m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{g.current&&y(!0)},t.refreshInterval))}},[e,t.method,t.body,t.headers,t.retries,t.retryDelay,t.refreshInterval,r]);return(0,n.useEffect)(()=>{let e=setTimeout(()=>{g.current&&!p.current&&y(!0)},1e3);return()=>{clearTimeout(e),m.current&&clearTimeout(m.current)}},[y]),{data:r,error:l,loading:f,refetch:(0,n.useCallback)(async()=>{await y(!0)},[y]),stopAutoRefresh:(0,n.useCallback)(()=>{m.current&&(clearTimeout(m.current),m.current=null)},[])}}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"POST",[r,a]=(0,n.useState)(null),[c,u]=(0,n.useState)(null),[i,l]=(0,n.useState)(!1);return{mutate:(0,n.useCallback)(async r=>{console.log("Mutation API - M\xe9thode: ".concat(t,", URL: ").concat(e,", Data:"),r),l(!0),u(null);let n=0;try{for(;n<=1;)try{console.log("Mutation API - Tentative ".concat(n+1,"/").concat(2));let c=new AbortController,u=setTimeout(()=>c.abort(),1e4),i=await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:r?JSON.stringify(r):void 0,signal:c.signal,cache:"no-cache"});if(clearTimeout(u),console.log("Mutation API - Statut de la r\xe9ponse: ".concat(i.status)),!i.ok){if(i.status>=500&&n<1){console.log("Mutation API - Erreur ".concat(i.status,", nouvelle tentative...")),n++,await o(1e3);continue}let e=await i.json().catch(()=>({}));throw console.log("Mutation API - Donn\xe9es d'erreur:",e),Error(e.error||"Erreur ".concat(i.status,": ").concat(i.statusText))}let l=await i.json();return console.log("Mutation API - R\xe9sultat:",l),a(l),e.includes("/tickets")&&(console.log("Mutation API - Invalidation du cache pour /api/tickets"),s("/api/tickets"),"DELETE"===t&&(console.log("Mutation API - Invalidation du cache pour ".concat(e)),s(e))),l}catch(t){if(t instanceof DOMException&&"AbortError"===t.name)throw Error("La requ\xeate a pris trop de temps");if(n<1)console.warn("Tentative de mutation \xe9chou\xe9e pour ".concat(e,". Nouvelle tentative...")),n++,await o(1e3);else throw t}throw Error("Toutes les tentatives ont \xe9chou\xe9")}catch(e){throw console.error("Mutation API - Erreur:",e),e instanceof TypeError&&e.message.includes("fetch")?u("Probl\xe8me de connexion au serveur. Veuillez v\xe9rifier votre connexion internet."):u(e instanceof Error?e.message:"Une erreur est survenue"),e}finally{l(!1)}},[e,t]),data:r,error:c,loading:i}}},93448:function(e,t,r){r.d(t,{cn:function(){return a},o:function(){return u},p:function(){return c}});var n=r(61994),o=r(53335);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.m6)((0,n.W)(t))}function c(e){try{let t=new Date(e);if(isNaN(t.getTime()))return"Date invalide";return new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)}catch(t){return console.error("Erreur de formatage de date:",t,e),"Date invalide"}}function u(e){try{let t=new Date(e);if(isNaN(t.getTime()))return"Date invalide";let r=new Date().getTime()-t.getTime(),n=Math.floor(r/6e4),o=Math.floor(r/36e5),a=Math.floor(r/864e5);if(n<60)return"Il y a ".concat(n," minute").concat(n>1?"s":"");if(o<24)return"Il y a ".concat(o," heure").concat(o>1?"s":"");if(a<7)return"Il y a ".concat(a," jour").concat(a>1?"s":"");return new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)}catch(t){return console.error("Erreur de formatage de date:",t,e),"Date invalide"}}}}]);
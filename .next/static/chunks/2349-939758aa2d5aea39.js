"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2349],{92349:function(e,s,t){t.d(s,{K:function(){return z}});var a=t(57437),r=t(2265),n=t(93448),l=t(79820),d=t(92369),i=t(96137),o=t(99897),c=t(71422),m=t(2296),u=t(86574),x=t(12658),f=t(27312);let p=f.fC,h=f.xz;f.ee;let j=r.forwardRef((e,s)=>{let{className:t,align:r="center",sideOffset:l=4,...d}=e;return(0,a.jsx)(f.h_,{children:(0,a.jsx)(f.VY,{ref:s,align:r,sideOffset:l,className:(0,n.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...d})})});j.displayName=f.VY.displayName;var N=t(12381),g=t(61312);let b=g.zt,y=g.fC,w=g.xz,v=r.forwardRef((e,s)=>{let{className:t,sideOffset:r=4,...l}=e;return(0,a.jsx)(g.h_,{children:(0,a.jsx)(g.VY,{ref:s,sideOffset:r,className:(0,n.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})})});v.displayName=g.VY.displayName;var D=t(50912);let C=["\uD83D\uDC4D","❤️","\uD83D\uDE02","\uD83D\uDE2E","\uD83D\uDE22","\uD83D\uDC4F","\uD83C\uDF89","\uD83D\uDE4F"];function z(e){let{message:s,index:t=0}=e,{userId:f}=(0,D.aC)(),[g,z]=(0,r.useState)(s.reactions||[]),k=async e=>{try{let t=await fetch("/api/messages/reactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messageId:s.id,emoji:e})});if(t.ok){let e=await t.json();z(s=>[...s.filter(s=>s.id!==e.id),e])}}catch(e){console.error("Erreur lors de l'ajout de la r\xe9action:",e)}},E=async e=>{try{(await fetch("/api/messages/reactions/".concat(e),{method:"DELETE"})).ok&&z(g.filter(s=>s.id!==e))}catch(e){console.error("Erreur lors de la suppression de la r\xe9action:",e)}},T=g.reduce((e,s)=>(e[s.emoji]||(e[s.emoji]=[]),e[s.emoji].push(s),e),{}),Z={client:"Client",admin:"Support",system:"Syst\xe8me"},R={client:(0,a.jsx)(d.Z,{className:"h-4 w-4 text-blue-500"}),admin:(0,a.jsx)(i.Z,{className:"h-4 w-4 text-green-500"}),system:(0,a.jsx)(o.Z,{className:"h-4 w-4 text-amber-500"})},O="system"===s.senderType,S=t%2==0;return(0,a.jsxs)("div",{className:"flex w-full ".concat(O?"justify-center":S?"justify-end":"justify-start"," mb-4"),children:[!O&&(0,a.jsxs)("div",{className:"max-w-[80%] ".concat(S?"ml-auto":"mr-auto"),children:[(0,a.jsx)("div",{className:"flex items-center mb-1",children:(0,a.jsxs)("div",{className:"flex items-center gap-1 text-xs ".concat(S?"ml-auto":""),children:[!S&&R[s.senderType],(0,a.jsx)("span",{className:"font-medium",children:S?"Vous":Z[s.senderType]}),S&&R[s.senderType]]})}),(0,a.jsxs)(l.Zb,{className:"rounded-2xl p-3 ".concat(S?"bg-primary/10 border-primary/20 rounded-tr-sm":"bg-muted/50 border-muted rounded-tl-sm"),children:[(0,a.jsx)("div",{className:"text-sm prose prose-sm dark:prose-invert max-w-none",children:(0,a.jsx)(m.UG,{components:{code:e=>{let{node:s,inline:t,className:r,children:n,...l}=e,d=/language-(\w+)/.exec(r||"");return!t&&d?(0,a.jsx)(u.Z,{style:x.Z,language:d[1],PreTag:"div",...l,children:String(n).replace(/\n$/,"")}):(0,a.jsx)("code",{className:"".concat(r," px-1 py-0.5 rounded bg-muted font-mono text-sm"),...l,children:n})},p:e=>{let{children:s}=e;return(0,a.jsx)("p",{className:"mb-2 last:mb-0",children:s})},ul:e=>{let{children:s}=e;return(0,a.jsx)("ul",{className:"list-disc pl-6 mb-2",children:s})},ol:e=>{let{children:s}=e;return(0,a.jsx)("ol",{className:"list-decimal pl-6 mb-2",children:s})},li:e=>{let{children:s}=e;return(0,a.jsx)("li",{className:"mb-1",children:s})},blockquote:e=>{let{children:s}=e;return(0,a.jsx)("blockquote",{className:"border-l-4 border-primary/30 pl-3 italic",children:s})}},children:s.content})}),Object.keys(T).length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:Object.entries(T).map(e=>{let[s,t]=e;return(0,a.jsx)(b,{children:(0,a.jsxs)(y,{children:[(0,a.jsx)(w,{asChild:!0,children:(0,a.jsxs)(N.z,{variant:"outline",size:"sm",className:"h-7 px-2 rounded-full bg-muted/50 hover:bg-muted",onClick:()=>{let e=t.find(e=>e.userId===f);e&&E(e.id)},children:[(0,a.jsx)("span",{className:"mr-1 text-lg",children:s}),(0,a.jsx)("span",{className:"text-xs",children:t.length})]})}),(0,a.jsx)(v,{children:t.map(e=>e.userName||"Utilisateur").join(", ")})]})},s)})}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[!s.read&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"h-2 w-2 rounded-full bg-primary"}),(0,a.jsx)("span",{className:"ml-1 text-xs text-primary",children:"Non lu"})]}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:(0,n.o)(s.createdAt)})]}),(0,a.jsxs)(p,{children:[(0,a.jsx)(h,{asChild:!0,children:(0,a.jsx)(N.z,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full ml-auto",children:(0,a.jsx)(c.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(j,{className:"w-auto p-3",align:"end",children:(0,a.jsx)("div",{className:"flex gap-2 flex-wrap max-w-[240px]",children:C.map(e=>(0,a.jsx)(N.z,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 text-xl",onClick:()=>k(e),children:e},e))})})]})]})]})]}),O&&(0,a.jsxs)(l.Zb,{className:"max-w-[90%] bg-amber-500/5 border-amber-500/20 rounded-md p-3 text-center",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-1 mb-1",children:[R[s.senderType],(0,a.jsx)("span",{className:"text-xs font-medium",children:Z[s.senderType]})]}),(0,a.jsx)("div",{className:"text-sm prose prose-sm dark:prose-invert max-w-none",children:(0,a.jsx)(m.UG,{children:s.content})}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:(0,n.o)(s.createdAt)})]})]})}},79820:function(e,s,t){t.d(s,{Ol:function(){return d},SZ:function(){return o},Zb:function(){return l},aY:function(){return c},eW:function(){return m},ll:function(){return i}});var a=t(57437),r=t(2265),n=t(93448);let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});l.displayName="Card";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...r})});d.displayName="CardHeader";let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:s,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});i.displayName="CardTitle";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...r})});o.displayName="CardDescription";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",t),...r})});c.displayName="CardContent";let m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",t),...r})});m.displayName="CardFooter"}}]);
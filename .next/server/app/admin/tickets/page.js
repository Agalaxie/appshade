(()=>{var e={};e.id=5314,e.ids=[5314],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},92048:e=>{"use strict";e.exports=require("fs")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},6162:e=>{"use strict";e.exports=require("worker_threads")},71568:e=>{"use strict";e.exports=require("zlib")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},87561:e=>{"use strict";e.exports=require("node:fs")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},87503:e=>{"use strict";e.exports=require("node:net")},49411:e=>{"use strict";e.exports=require("node:path")},97742:e=>{"use strict";e.exports=require("node:process")},84492:e=>{"use strict";e.exports=require("node:stream")},72477:e=>{"use strict";e.exports=require("node:stream/web")},41041:e=>{"use strict";e.exports=require("node:url")},47261:e=>{"use strict";e.exports=require("node:util")},65628:e=>{"use strict";e.exports=require("node:zlib")},79708:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),r(28164),r(37877),r(35866);var s=r(23191),a=r(88716),n=r(37922),i=r.n(n),l=r(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d=["",{children:["admin",{children:["tickets",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,28164)),"C:\\Users\\audif\\Desktop\\appshade\\src\\app\\admin\\tickets\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,37877)),"C:\\Users\\audif\\Desktop\\appshade\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\audif\\Desktop\\appshade\\src\\app\\admin\\tickets\\page.tsx"],u="/admin/tickets/page",m={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/tickets/page",pathname:"/admin/tickets",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},37292:(e,t,r)=>{Promise.resolve().then(r.bind(r,89687))},41137:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(76557).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},49216:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(76557).Z)("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},21405:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(76557).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},88307:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(76557).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},89687:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var s=r(10326),a=r(17577),n=r(90434),i=r(5635),l=r(37138),o=r(91664),d=r(41190),c=r(38443),u=r(95237),m=r(88307),x=r(21405),p=r(41137),h=r(49216),f=r(12470),g=r(51641),b=r(38227),j=r(51223);function y(){let[e,t]=(0,a.useState)(""),[r,y]=(0,a.useState)("all"),[v,w]=(0,a.useState)(0),{data:N,error:k,loading:C,refetch:E}=(0,f.h_)("/api/tickets",{refreshInterval:null}),q=N?N.filter(t=>{let s=t.title?.toLowerCase().includes(e.toLowerCase())||t.id?.toLowerCase().includes(e.toLowerCase())||t.clientName?.toLowerCase().includes(e.toLowerCase())||!1,a="all"===r||t.status===r;return s&&a}):[];return(0,s.jsxs)(l.Hn,{children:[s.jsx(i.g,{}),(0,s.jsxs)(l.kV,{children:[(0,s.jsxs)("header",{className:"flex h-16 shrink-0 items-center justify-between gap-2 border-b px-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(l.vP,{}),s.jsx("h1",{className:"text-xl font-semibold",children:"Tous les tickets"})]}),s.jsx("div",{className:"flex items-center gap-2",children:(0,s.jsxs)(c.C,{variant:"outline",className:"font-normal",children:[q.length," tickets"]})})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-auto p-4",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 items-start md:items-center",children:[(0,s.jsxs)("div",{className:"relative",children:[s.jsx(m.Z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),s.jsx(d.I,{placeholder:"Rechercher un ticket...",className:"w-full md:w-auto pl-8",value:e,onChange:e=>t(e.target.value)})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[s.jsx(o.z,{variant:"outline",size:"sm",onClick:()=>y("all"),className:"all"===r?"bg-primary text-primary-foreground":"",children:"Tous"}),s.jsx(o.z,{variant:"outline",size:"sm",onClick:()=>y("open"),className:"open"===r?"bg-primary text-primary-foreground":"",children:"En attente"}),s.jsx(o.z,{variant:"outline",size:"sm",onClick:()=>y("in_progress"),className:"in_progress"===r?"bg-primary text-primary-foreground":"",children:"En cours"}),s.jsx(o.z,{variant:"outline",size:"sm",onClick:()=>y("closed"),className:"closed"===r?"bg-primary text-primary-foreground":"",children:"Ferm\xe9s"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(o.z,{variant:"outline",size:"sm",onClick:()=>{g.kg.debug("Rafra\xeechissement manuel des tickets admin"),w(e=>e+1),E()},className:"flex items-center gap-1",children:[s.jsx(x.Z,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden md:inline",children:"Actualiser"})]}),(0,s.jsxs)(o.z,{variant:"outline",size:"sm",className:"flex items-center gap-1",children:[s.jsx(p.Z,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden md:inline",children:"Filtres avanc\xe9s"})]})]})]}),s.jsx("div",{className:"rounded-md border overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-muted/50",children:(0,s.jsxs)("tr",{className:"hidden md:table-row",children:[s.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground",children:"ID"}),s.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground",children:"Titre"}),s.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground",children:"Client"}),s.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground",children:"Statut"}),s.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground",children:"Priorit\xe9"}),s.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground",children:"Date"}),s.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground",children:"Actions"})]})}),s.jsx("tbody",{children:C?Array.from({length:5}).map((e,t)=>(0,s.jsxs)("tr",{className:"border-t",children:[s.jsx("td",{className:"p-4 align-middle",children:s.jsx(b.O,{className:"h-4 w-[40px]"})}),s.jsx("td",{className:"p-4 align-middle",children:s.jsx(b.O,{className:"h-4 w-[200px]"})}),s.jsx("td",{className:"p-4 align-middle",children:s.jsx(b.O,{className:"h-4 w-[120px]"})}),s.jsx("td",{className:"p-4 align-middle",children:s.jsx(b.O,{className:"h-4 w-[80px]"})}),s.jsx("td",{className:"p-4 align-middle",children:s.jsx(b.O,{className:"h-4 w-[80px]"})}),s.jsx("td",{className:"p-4 align-middle",children:s.jsx(b.O,{className:"h-4 w-[120px]"})}),s.jsx("td",{className:"p-4 align-middle",children:s.jsx(b.O,{className:"h-8 w-8 rounded-full"})})]},t)):k?s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"p-4 text-center text-sm text-muted-foreground",children:"Une erreur est survenue lors du chargement des tickets"})}):0===q.length?s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"p-4 text-center text-sm text-muted-foreground",children:"Aucun ticket trouv\xe9"})}):q.map(e=>(0,s.jsxs)("tr",{className:"border-t hover:bg-muted/50 md:table-row flex flex-col p-4 md:p-0",children:[(0,s.jsxs)("td",{className:"md:p-4 md:align-middle md:table-cell flex justify-between items-center",children:[s.jsx("span",{className:"font-medium md:font-normal md:hidden",children:"ID:"}),(0,s.jsxs)("span",{children:["#",e.id.substring(0,8)]})]}),(0,s.jsxs)("td",{className:"md:p-4 md:align-middle md:table-cell flex justify-between items-center",children:[s.jsx("span",{className:"font-medium md:font-normal md:hidden",children:"Titre:"}),s.jsx(n.default,{href:`/admin/tickets/${e.id}`,className:"font-medium hover:underline",children:e.title})]}),(0,s.jsxs)("td",{className:"md:p-4 md:align-middle md:table-cell flex justify-between items-center",children:[s.jsx("span",{className:"font-medium md:font-normal md:hidden",children:"Client:"}),s.jsx("span",{children:e.clientName||e.user?.firstName||"Client"})]}),(0,s.jsxs)("td",{className:"md:p-4 md:align-middle md:table-cell flex justify-between items-center",children:[s.jsx("span",{className:"font-medium md:font-normal md:hidden",children:"Statut:"}),s.jsx(u.O,{status:e.status})]}),(0,s.jsxs)("td",{className:"md:p-4 md:align-middle md:table-cell flex justify-between items-center",children:[s.jsx("span",{className:"font-medium md:font-normal md:hidden",children:"Priorit\xe9:"}),s.jsx(c.C,{variant:"outline",className:(0,j.cn)("high"===e.priority?"border-red-500 text-red-500":"medium"===e.priority?"border-yellow-500 text-yellow-500":"border-green-500 text-green-500"),children:"high"===e.priority?"Haute":"medium"===e.priority?"Moyenne":"Basse"})]}),(0,s.jsxs)("td",{className:"md:p-4 md:align-middle md:table-cell flex justify-between items-center",children:[s.jsx("span",{className:"font-medium md:font-normal md:hidden",children:"Date:"}),s.jsx("span",{className:"text-sm text-muted-foreground",children:(0,j.p)(e.createdAt)})]}),(0,s.jsxs)("td",{className:"md:p-4 md:align-middle md:table-cell flex justify-between items-center",children:[s.jsx("span",{className:"font-medium md:font-normal md:hidden",children:"Actions:"}),(0,s.jsxs)(o.z,{variant:"ghost",size:"icon",children:[s.jsx(h.Z,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Actions"})]})]})]},e.id))})]})})})]})]})]})}},38443:(e,t,r)=>{"use strict";r.d(t,{C:()=>l});var s=r(10326);r(17577);var a=r(79360),n=r(51223);let i=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,...r}){return s.jsx("div",{className:(0,n.cn)(i({variant:t}),e),...r})}},41190:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});var s=r(10326),a=r(17577),n=r(51223);let i=a.forwardRef(({className:e,type:t,...r},a)=>s.jsx("input",{type:t,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...r}));i.displayName="Input"},38227:(e,t,r)=>{"use strict";r.d(t,{O:()=>n});var s=r(10326),a=r(51223);function n({className:e,...t}){return s.jsx("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",e),...t})}},95237:(e,t,r)=>{"use strict";r.d(t,{O:()=>n});var s=r(10326);r(17577);var a=r(51223);function n({status:e,className:t,children:r,...n}){return s.jsx("span",{className:(0,a.cn)("inline-flex items-center rounded-md border px-2 py-1 text-xs font-medium",function(e){switch(e){case"open":case"En attente":case"backlog":return"bg-yellow-50 text-yellow-700 dark:bg-yellow-400/10 dark:text-yellow-400 border-yellow-300 dark:border-yellow-400/20";case"in_progress":case"En cours":case"in-progress":return"bg-blue-50 text-blue-700 dark:bg-blue-400/10 dark:text-blue-400 border-blue-300 dark:border-blue-400/20";case"closed":case"Ferm\xe9":case"done":return"bg-green-50 text-green-700 dark:bg-green-400/10 dark:text-green-400 border-green-300 dark:border-green-400/20";case"todo":default:return"bg-gray-50 text-gray-700 dark:bg-gray-400/10 dark:text-gray-400 border-gray-300 dark:border-gray-400/20";case"canceled":return"bg-red-50 text-red-700 dark:bg-red-400/10 dark:text-red-400 border-red-300 dark:border-red-400/20"}}(e),t),...n,children:r||e})}},12470:(e,t,r)=>{"use strict";r.d(t,{Db:()=>u,h_:()=>c,x1:()=>d});var s=r(17577);let a=e=>new Promise(t=>setTimeout(t,e)),n=new Map,i=new Map,l=new Map,o=new Map;function d(e){if(!e){n.clear(),console.log("Cache API enti\xe8rement vid\xe9");return}if(n.has(e)){n.delete(e),console.log(`Cache pour ${e} vid\xe9`);return}let t=0;for(let r of Array.from(n.keys()))r.includes(e)&&(n.delete(r),t++);t>0&&console.log(`${t} entr\xe9es de cache contenant "${e}" ont \xe9t\xe9 vid\xe9es`)}function c(e,t={}){let[r,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(null),[m,x]=(0,s.useState)(!0),p=(0,s.useRef)(null),h=(0,s.useRef)(!0),f=(0,s.useRef)(!0),g=(0,s.useRef)(!1);if(!e||""===e)return{data:null,error:"URL invalide",loading:!1,refetch:async()=>{},stopAutoRefresh:()=>{}};let b=(0,s.useCallback)(async(s=!1)=>{if(g.current&&!s||i.get(e))return;let c=Date.now(),m=l.get(e)||0;if(!s&&!f.current&&c-m<1e4)return;if(i.set(e,!0),l.set(e,c),g.current=!0,!s){let t=n.get(e);if(t&&c-t.timestamp<6e4){h.current&&(d(t.data),x(!1)),i.set(e,!1);return}}let j=t.retries||1,y=t.retryDelay||2e3,v=0,w=!1;try{for(h.current&&(r||x(!0),u(null));!w&&v<=j;)try{let r={method:t.method||"GET",headers:{"Content-Type":"application/json",...t.headers},cache:"no-store"};t.body&&"GET"!==t.method&&(r.body=JSON.stringify(t.body));let s=new AbortController,a=setTimeout(()=>s.abort(),15e3);r.signal=s.signal;let i=await fetch(e,r);if(clearTimeout(a),!i.ok){if(i.status>=500&&v<j)throw Error(`Erreur serveur ${i.status}`);if(401===i.status)throw Error("Vous devez \xeatre connect\xe9 pour acc\xe9der \xe0 cette ressource");let e=await i.json().catch(()=>({}));throw Error(e.error||`Erreur ${i.status}: ${i.statusText}`)}let l=await i.json();n.set(e,{data:l,timestamp:Date.now()}),h.current&&d(l),w=!0,f.current=!1;break}catch(t){if(t instanceof DOMException&&"AbortError"===t.name)throw Error("La requ\xeate a pris trop de temps");if(v<j)0===v&&console.warn(`Tentative \xe9chou\xe9e pour ${e}. Nouvelle tentative...`),await a(y*(v+1)),v++;else throw t}}catch(t){console.error(`Erreur lors de l'appel \xe0 ${e}`),r?h.current&&u("Erreur de rafra\xeechissement. Donn\xe9es potentiellement obsol\xe8tes."):t instanceof TypeError&&t.message.includes("fetch")?h.current&&u("Probl\xe8me de connexion au serveur. Veuillez v\xe9rifier votre connexion internet."):h.current&&u(t instanceof Error?t.message:"Une erreur est survenue")}finally{1>=(o.get(e)||0)&&i.set(e,!1),h.current&&x(!1),h.current&&t.refreshInterval&&t.refreshInterval>0&&(p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{h.current&&b(!0)},t.refreshInterval))}},[e,t.method,t.body,t.headers,t.retries,t.retryDelay,t.refreshInterval,r]);return{data:r,error:c,loading:m,refetch:(0,s.useCallback)(async()=>{await b(!0)},[b]),stopAutoRefresh:(0,s.useCallback)(()=>{p.current&&(clearTimeout(p.current),p.current=null)},[])}}function u(e,t="POST"){let[r,n]=(0,s.useState)(null),[i,l]=(0,s.useState)(null),[o,c]=(0,s.useState)(!1);return{mutate:(0,s.useCallback)(async r=>{console.log(`Mutation API - M\xe9thode: ${t}, URL: ${e}, Data:`,r),c(!0),l(null);let s=0;try{for(;s<=1;)try{console.log(`Mutation API - Tentative ${s+1}/2`);let i=new AbortController,l=setTimeout(()=>i.abort(),1e4),o=await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:r?JSON.stringify(r):void 0,signal:i.signal,cache:"no-cache"});if(clearTimeout(l),console.log(`Mutation API - Statut de la r\xe9ponse: ${o.status}`),!o.ok){if(o.status>=500&&s<1){console.log(`Mutation API - Erreur ${o.status}, nouvelle tentative...`),s++,await a(1e3);continue}let e=await o.json().catch(()=>({}));throw console.log(`Mutation API - Donn\xe9es d'erreur:`,e),Error(e.error||`Erreur ${o.status}: ${o.statusText}`)}let c=await o.json();return console.log(`Mutation API - R\xe9sultat:`,c),n(c),e.includes("/tickets")&&(console.log("Mutation API - Invalidation du cache pour /api/tickets"),d("/api/tickets"),"DELETE"===t&&(console.log(`Mutation API - Invalidation du cache pour ${e}`),d(e))),c}catch(t){if(t instanceof DOMException&&"AbortError"===t.name)throw Error("La requ\xeate a pris trop de temps");if(s<1)console.warn(`Tentative de mutation \xe9chou\xe9e pour ${e}. Nouvelle tentative...`),s++,await a(1e3);else throw t}throw Error("Toutes les tentatives ont \xe9chou\xe9")}catch(e){throw console.error("Mutation API - Erreur:",e),e instanceof TypeError&&e.message.includes("fetch")?l("Probl\xe8me de connexion au serveur. Veuillez v\xe9rifier votre connexion internet."):l(e instanceof Error?e.message:"Une erreur est survenue"),e}finally{c(!1)}},[e,t]),data:r,error:i,loading:o}}},28164:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(68570).createProxy)(String.raw`C:\Users\audif\Desktop\appshade\src\app\admin\tickets\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[2510,4140,2497,4661,5232,9014,2255,5635],()=>r(79708));module.exports=s})();
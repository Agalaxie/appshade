(()=>{var e={};e.id=8394,e.ids=[8394],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},92048:e=>{"use strict";e.exports=require("fs")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},6162:e=>{"use strict";e.exports=require("worker_threads")},71568:e=>{"use strict";e.exports=require("zlib")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},87561:e=>{"use strict";e.exports=require("node:fs")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},87503:e=>{"use strict";e.exports=require("node:net")},49411:e=>{"use strict";e.exports=require("node:path")},97742:e=>{"use strict";e.exports=require("node:process")},84492:e=>{"use strict";e.exports=require("node:stream")},72477:e=>{"use strict";e.exports=require("node:stream/web")},41041:e=>{"use strict";e.exports=require("node:url")},47261:e=>{"use strict";e.exports=require("node:util")},65628:e=>{"use strict";e.exports=require("node:zlib")},50903:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),s(99236),s(37877),s(35866);var r=s(23191),a=s(88716),n=s(37922),l=s.n(n),i=s(95231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let c=["",{children:["client",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,99236)),"C:\\Users\\audif\\Desktop\\appshade\\src\\app\\client\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,37877)),"C:\\Users\\audif\\Desktop\\appshade\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\audif\\Desktop\\appshade\\src\\app\\client\\page.tsx"],u="/client/page",x={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/client/page",pathname:"/client",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},85748:(e,t,s)=>{Promise.resolve().then(s.bind(s,95586))},48998:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(76557).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},79635:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(76557).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},95586:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var r=s(10326);s(17577);var a=s(90434),n=s(10074),l=s(37138),i=s(29752),o=s(21985),c=s(40617),d=s(48998),u=s(12470),x=s(51223),m=s(38227);function p(){let{data:e,loading:t,error:s}=(0,u.h_)("/api/tickets"),p=e?.filter(e=>"closed"!==e.status)?.length||0,f=e?.reduce((e,t)=>e+(t.messages?.filter(e=>!e.read)?.length||0),0)||0;return(0,r.jsxs)(l.Hn,{defaultCollapsed:!1,collapsible:"expanded",children:[r.jsx(n.X,{}),(0,r.jsxs)(l.kV,{children:[r.jsx("header",{className:"flex h-16 shrink-0 items-center gap-2 border-b",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 px-4",children:[r.jsx(l.vP,{}),r.jsx("h1",{className:"text-xl font-semibold",children:"Tableau de bord"})]})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-4 p-4",children:[(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(i.ll,{className:"text-sm font-medium",children:"Tickets actifs"}),r.jsx(o.Z,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsx(i.aY,{children:r.jsx("div",{className:"text-2xl font-bold",children:p})})]}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(i.ll,{className:"text-sm font-medium",children:"Messages non lus"}),r.jsx(c.Z,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsx(i.aY,{children:r.jsx("div",{className:"text-2xl font-bold",children:f})})]}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(i.ll,{className:"text-sm font-medium",children:"Temps de r\xe9ponse moyen"}),r.jsx(d.Z,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsx(i.aY,{children:r.jsx("div",{className:"text-2xl font-bold",children:"~2h"})})]})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-7",children:[(0,r.jsxs)(i.Zb,{className:"md:col-span-2 lg:col-span-4",children:[(0,r.jsxs)(i.Ol,{children:[r.jsx(i.ll,{children:"Tickets r\xe9cents"}),r.jsx(i.SZ,{children:"Vos tickets les plus r\xe9cents"})]}),r.jsx(i.aY,{children:t?r.jsx("div",{className:"space-y-2",children:[1,2,3].map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-md border p-3",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[r.jsx(m.O,{className:"h-4 w-[200px]"}),r.jsx(m.O,{className:"h-3 w-[150px]"})]}),r.jsx(m.O,{className:"h-6 w-[80px]"})]},e))}):s?r.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Une erreur est survenue lors du chargement des tickets"}):e&&e.length>0?r.jsx("div",{className:"flex flex-col gap-4",children:e.slice(0,3).map(e=>r.jsx(a.default,{href:`/client/tickets/${e.id}`,className:"block p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-md border p-3",children:[(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium",children:e.title}),r.jsx("div",{className:"text-sm text-muted-foreground",children:(0,x.p)(e.createdAt)})]}),r.jsx("div",{className:"text-sm",children:r.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${"in_progress"===e.status?"bg-blue-50 text-blue-700":"open"===e.status?"bg-yellow-50 text-yellow-700":"bg-green-50 text-green-700"}`,children:"open"===e.status?"En attente":"in_progress"===e.status?"En cours":"Ferm\xe9"})})]})},e.id))}):r.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Aucun ticket r\xe9cent"})})]}),(0,r.jsxs)(i.Zb,{className:"md:col-span-2 lg:col-span-3",children:[(0,r.jsxs)(i.Ol,{children:[r.jsx(i.ll,{children:"Messages r\xe9cents"}),r.jsx(i.SZ,{children:"Vos derniers messages"})]}),r.jsx(i.aY,{children:t?r.jsx("div",{className:"space-y-2",children:[1,2,3].map(e=>(0,r.jsxs)("div",{className:"flex flex-col gap-1 rounded-md border p-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx(m.O,{className:"h-4 w-[100px]"}),r.jsx(m.O,{className:"h-3 w-[80px]"})]}),r.jsx(m.O,{className:"h-4 w-full"})]},e))}):s?r.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Une erreur est survenue lors du chargement des messages"}):e&&e.some(e=>(e.messages||[]).length>0)?r.jsx("div",{className:"space-y-2",children:e.flatMap(e=>(e.messages||[]).map(t=>({...t,ticketTitle:e.title}))).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()).slice(0,3).map(e=>(0,r.jsxs)("div",{className:"flex flex-col gap-1 rounded-md border p-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"font-medium",children:"admin"===e.senderType?"Support":"Syst\xe8me"}),r.jsx("div",{className:"text-xs text-muted-foreground",children:(0,x.p)(e.createdAt)})]}),r.jsx("p",{className:"text-sm",children:e.content}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Re: ",e.ticketTitle]})]},e.id))}):r.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Aucun message r\xe9cent"})})]})]})]})]})]})}},29752:(e,t,s)=>{"use strict";s.d(t,{Ol:()=>i,SZ:()=>c,Zb:()=>l,aY:()=>d,eW:()=>u,ll:()=>o});var r=s(10326),a=s(17577),n=s(51223);let l=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));l.displayName="Card";let i=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...t}));i.displayName="CardHeader";let o=a.forwardRef(({className:e,...t},s)=>r.jsx("h3",{ref:s,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle";let c=a.forwardRef(({className:e,...t},s)=>r.jsx("p",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));c.displayName="CardDescription";let d=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,n.cn)("p-6 pt-0",e),...t}));d.displayName="CardContent";let u=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",e),...t}));u.displayName="CardFooter"},38227:(e,t,s)=>{"use strict";s.d(t,{O:()=>n});var r=s(10326),a=s(51223);function n({className:e,...t}){return r.jsx("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",e),...t})}},12470:(e,t,s)=>{"use strict";s.d(t,{Db:()=>u,h_:()=>d,x1:()=>c});var r=s(17577);let a=e=>new Promise(t=>setTimeout(t,e)),n=new Map,l=new Map,i=new Map,o=new Map;function c(e){if(!e){n.clear(),console.log("Cache API enti\xe8rement vid\xe9");return}if(n.has(e)){n.delete(e),console.log(`Cache pour ${e} vid\xe9`);return}let t=0;for(let s of Array.from(n.keys()))s.includes(e)&&(n.delete(s),t++);t>0&&console.log(`${t} entr\xe9es de cache contenant "${e}" ont \xe9t\xe9 vid\xe9es`)}function d(e,t={}){let[s,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(null),[x,m]=(0,r.useState)(!0),p=(0,r.useRef)(null),f=(0,r.useRef)(!0),h=(0,r.useRef)(!0),g=(0,r.useRef)(!1);if(!e||""===e)return{data:null,error:"URL invalide",loading:!1,refetch:async()=>{},stopAutoRefresh:()=>{}};let j=(0,r.useCallback)(async(r=!1)=>{if(g.current&&!r||l.get(e))return;let d=Date.now(),x=i.get(e)||0;if(!r&&!h.current&&d-x<1e4)return;if(l.set(e,!0),i.set(e,d),g.current=!0,!r){let t=n.get(e);if(t&&d-t.timestamp<6e4){f.current&&(c(t.data),m(!1)),l.set(e,!1);return}}let v=t.retries||1,b=t.retryDelay||2e3,y=0,N=!1;try{for(f.current&&(s||m(!0),u(null));!N&&y<=v;)try{let s={method:t.method||"GET",headers:{"Content-Type":"application/json",...t.headers},cache:"no-store"};t.body&&"GET"!==t.method&&(s.body=JSON.stringify(t.body));let r=new AbortController,a=setTimeout(()=>r.abort(),15e3);s.signal=r.signal;let l=await fetch(e,s);if(clearTimeout(a),!l.ok){if(l.status>=500&&y<v)throw Error(`Erreur serveur ${l.status}`);if(401===l.status)throw Error("Vous devez \xeatre connect\xe9 pour acc\xe9der \xe0 cette ressource");let e=await l.json().catch(()=>({}));throw Error(e.error||`Erreur ${l.status}: ${l.statusText}`)}let i=await l.json();n.set(e,{data:i,timestamp:Date.now()}),f.current&&c(i),N=!0,h.current=!1;break}catch(t){if(t instanceof DOMException&&"AbortError"===t.name)throw Error("La requ\xeate a pris trop de temps");if(y<v)0===y&&console.warn(`Tentative \xe9chou\xe9e pour ${e}. Nouvelle tentative...`),await a(b*(y+1)),y++;else throw t}}catch(t){console.error(`Erreur lors de l'appel \xe0 ${e}`),s?f.current&&u("Erreur de rafra\xeechissement. Donn\xe9es potentiellement obsol\xe8tes."):t instanceof TypeError&&t.message.includes("fetch")?f.current&&u("Probl\xe8me de connexion au serveur. Veuillez v\xe9rifier votre connexion internet."):f.current&&u(t instanceof Error?t.message:"Une erreur est survenue")}finally{1>=(o.get(e)||0)&&l.set(e,!1),f.current&&m(!1),f.current&&t.refreshInterval&&t.refreshInterval>0&&(p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{f.current&&j(!0)},t.refreshInterval))}},[e,t.method,t.body,t.headers,t.retries,t.retryDelay,t.refreshInterval,s]);return{data:s,error:d,loading:x,refetch:(0,r.useCallback)(async()=>{await j(!0)},[j]),stopAutoRefresh:(0,r.useCallback)(()=>{p.current&&(clearTimeout(p.current),p.current=null)},[])}}function u(e,t="POST"){let[s,n]=(0,r.useState)(null),[l,i]=(0,r.useState)(null),[o,d]=(0,r.useState)(!1);return{mutate:(0,r.useCallback)(async s=>{console.log(`Mutation API - M\xe9thode: ${t}, URL: ${e}, Data:`,s),d(!0),i(null);let r=0;try{for(;r<=1;)try{console.log(`Mutation API - Tentative ${r+1}/2`);let l=new AbortController,i=setTimeout(()=>l.abort(),1e4),o=await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:s?JSON.stringify(s):void 0,signal:l.signal,cache:"no-cache"});if(clearTimeout(i),console.log(`Mutation API - Statut de la r\xe9ponse: ${o.status}`),!o.ok){if(o.status>=500&&r<1){console.log(`Mutation API - Erreur ${o.status}, nouvelle tentative...`),r++,await a(1e3);continue}let e=await o.json().catch(()=>({}));throw console.log(`Mutation API - Donn\xe9es d'erreur:`,e),Error(e.error||`Erreur ${o.status}: ${o.statusText}`)}let d=await o.json();return console.log(`Mutation API - R\xe9sultat:`,d),n(d),e.includes("/tickets")&&(console.log("Mutation API - Invalidation du cache pour /api/tickets"),c("/api/tickets"),"DELETE"===t&&(console.log(`Mutation API - Invalidation du cache pour ${e}`),c(e))),d}catch(t){if(t instanceof DOMException&&"AbortError"===t.name)throw Error("La requ\xeate a pris trop de temps");if(r<1)console.warn(`Tentative de mutation \xe9chou\xe9e pour ${e}. Nouvelle tentative...`),r++,await a(1e3);else throw t}throw Error("Toutes les tentatives ont \xe9chou\xe9")}catch(e){throw console.error("Mutation API - Erreur:",e),e instanceof TypeError&&e.message.includes("fetch")?i("Probl\xe8me de connexion au serveur. Veuillez v\xe9rifier votre connexion internet."):i(e instanceof Error?e.message:"Une erreur est survenue"),e}finally{d(!1)}},[e,t]),data:s,error:l,loading:o}}},99236:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(68570).createProxy)(String.raw`C:\Users\audif\Desktop\appshade\src\app\client\page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[2510,4140,2497,4661,5232,9014,2255,74],()=>s(50903));module.exports=r})();
"use strict";exports.id=2725,exports.ids=[2725],exports.modules={82725:(e,s,a)=>{a.d(s,{K:()=>z});var t=a(10326),r=a(17577),d=a(51223),l=a(29752),i=a(79635),n=a(93892),o=a(2634),m=a(15515),c=a(41206),x=a(21468),p=a(20800),f=a(74964);let u=f.fC,h=f.xz;f.ee;let j=r.forwardRef(({className:e,align:s="center",sideOffset:a=4,...r},l)=>t.jsx(f.h_,{children:t.jsx(f.VY,{ref:l,align:s,sideOffset:a,className:(0,d.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));j.displayName=f.VY.displayName;var N=a(91664),g=a(39313);let y=g.zt,b=g.fC,w=g.xz,v=r.forwardRef(({className:e,sideOffset:s=4,...a},r)=>t.jsx(g.h_,{children:t.jsx(g.VY,{ref:r,sideOffset:s,className:(0,d.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));v.displayName=g.VY.displayName;var D=a(69988);let C=["\uD83D\uDC4D","❤️","\uD83D\uDE02","\uD83D\uDE2E","\uD83D\uDE22","\uD83D\uDC4F","\uD83C\uDF89","\uD83D\uDE4F"];function z({message:e,index:s=0}){let{userId:a}=(0,D.aC)(),[f,g]=(0,r.useState)(e.reactions||[]),z=async s=>{try{let a=await fetch("/api/messages/reactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messageId:e.id,emoji:s})});if(a.ok){let e=await a.json();g(s=>[...s.filter(s=>s.id!==e.id),e])}}catch(e){console.error("Erreur lors de l'ajout de la r\xe9action:",e)}},T=async e=>{try{(await fetch(`/api/messages/reactions/${e}`,{method:"DELETE"})).ok&&g(f.filter(s=>s.id!==e))}catch(e){console.error("Erreur lors de la suppression de la r\xe9action:",e)}},k=f.reduce((e,s)=>(e[s.emoji]||(e[s.emoji]=[]),e[s.emoji].push(s),e),{}),E={client:"Client",admin:"Support",system:"Syst\xe8me"},Z={client:t.jsx(i.Z,{className:"h-4 w-4 text-blue-500"}),admin:t.jsx(n.Z,{className:"h-4 w-4 text-green-500"}),system:t.jsx(o.Z,{className:"h-4 w-4 text-amber-500"})},R="system"===e.senderType,O=s%2==0;return(0,t.jsxs)("div",{className:`flex w-full ${R?"justify-center":O?"justify-end":"justify-start"} mb-4`,children:[!R&&(0,t.jsxs)("div",{className:`max-w-[80%] ${O?"ml-auto":"mr-auto"}`,children:[t.jsx("div",{className:"flex items-center mb-1",children:(0,t.jsxs)("div",{className:`flex items-center gap-1 text-xs ${O?"ml-auto":""}`,children:[!O&&Z[e.senderType],t.jsx("span",{className:"font-medium",children:O?"Vous":E[e.senderType]}),O&&Z[e.senderType]]})}),(0,t.jsxs)(l.Zb,{className:`rounded-2xl p-3 ${O?"bg-primary/10 border-primary/20 rounded-tr-sm":"bg-muted/50 border-muted rounded-tl-sm"}`,children:[t.jsx("div",{className:"text-sm prose prose-sm dark:prose-invert max-w-none",children:t.jsx(c.UG,{components:{code:({node:e,inline:s,className:a,children:r,...d})=>{let l=/language-(\w+)/.exec(a||"");return!s&&l?t.jsx(x.Z,{style:p.Z,language:l[1],PreTag:"div",...d,children:String(r).replace(/\n$/,"")}):t.jsx("code",{className:`${a} px-1 py-0.5 rounded bg-muted font-mono text-sm`,...d,children:r})},p:({children:e})=>t.jsx("p",{className:"mb-2 last:mb-0",children:e}),ul:({children:e})=>t.jsx("ul",{className:"list-disc pl-6 mb-2",children:e}),ol:({children:e})=>t.jsx("ol",{className:"list-decimal pl-6 mb-2",children:e}),li:({children:e})=>t.jsx("li",{className:"mb-1",children:e}),blockquote:({children:e})=>t.jsx("blockquote",{className:"border-l-4 border-primary/30 pl-3 italic",children:e})},children:e.content})}),Object.keys(k).length>0&&t.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:Object.entries(k).map(([e,s])=>t.jsx(y,{children:(0,t.jsxs)(b,{children:[t.jsx(w,{asChild:!0,children:(0,t.jsxs)(N.z,{variant:"outline",size:"sm",className:"h-7 px-2 rounded-full bg-muted/50 hover:bg-muted",onClick:()=>{let e=s.find(e=>e.userId===a);e&&T(e.id)},children:[t.jsx("span",{className:"mr-1 text-lg",children:e}),t.jsx("span",{className:"text-xs",children:s.length})]})}),t.jsx(v,{children:s.map(e=>e.userName||"Utilisateur").join(", ")})]})},e))}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[!e.read&&(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx("span",{className:"h-2 w-2 rounded-full bg-primary"}),t.jsx("span",{className:"ml-1 text-xs text-primary",children:"Non lu"})]}),t.jsx("span",{className:"text-xs text-muted-foreground",children:(0,d.o)(e.createdAt)})]}),(0,t.jsxs)(u,{children:[t.jsx(h,{asChild:!0,children:t.jsx(N.z,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full ml-auto",children:t.jsx(m.Z,{className:"h-4 w-4"})})}),t.jsx(j,{className:"w-auto p-3",align:"end",children:t.jsx("div",{className:"flex gap-2 flex-wrap max-w-[240px]",children:C.map(e=>t.jsx(N.z,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 text-xl",onClick:()=>z(e),children:e},e))})})]})]})]})]}),R&&(0,t.jsxs)(l.Zb,{className:"max-w-[90%] bg-amber-500/5 border-amber-500/20 rounded-md p-3 text-center",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center gap-1 mb-1",children:[Z[e.senderType],t.jsx("span",{className:"text-xs font-medium",children:E[e.senderType]})]}),t.jsx("div",{className:"text-sm prose prose-sm dark:prose-invert max-w-none",children:t.jsx(c.UG,{children:e.content})}),t.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:(0,d.o)(e.createdAt)})]})]})}},29752:(e,s,a)=>{a.d(s,{Ol:()=>i,SZ:()=>o,Zb:()=>l,aY:()=>m,eW:()=>c,ll:()=>n});var t=a(10326),r=a(17577),d=a(51223);let l=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,d.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));l.displayName="Card";let i=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",e),...s}));i.displayName="CardHeader";let n=r.forwardRef(({className:e,...s},a)=>t.jsx("h3",{ref:a,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));n.displayName="CardTitle";let o=r.forwardRef(({className:e,...s},a)=>t.jsx("p",{ref:a,className:(0,d.cn)("text-sm text-muted-foreground",e),...s}));o.displayName="CardDescription";let m=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,d.cn)("p-6 pt-0",e),...s}));m.displayName="CardContent";let c=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,d.cn)("flex items-center p-6 pt-0",e),...s}));c.displayName="CardFooter"}};